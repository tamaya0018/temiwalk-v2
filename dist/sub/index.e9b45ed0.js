var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},n=e.parcelRequire87e6;null==n&&((n=function(e){if(e in t)return t[e].exports;if(e in o){var n=o[e];delete o[e];var a={id:e,exports:{}};return t[e]=a,n.call(a.exports,a,a.exports),a.exports}var i=Error("Cannot find module '"+e+"'");throw i.code="MODULE_NOT_FOUND",i}).register=function(e,t){o[e]=t},e.parcelRequire87e6=n),n("hlpVk");var a=n("hlpVk"),i=n("aohA3");function r(e){this.roomName=e}function l(e,t,o){r.call(this,e),this.buttonArea=t,this.remoteMediaArea=o}Object.assign(r.prototype,{initMyContext:async function(e){let t=await (0,a.SkyWayContext).Create((0,i.getToken)(e)),o=await (0,a.SkyWayRoom).FindOrCreate(t,{type:"p2p",name:this.roomName}),n=await o.join();this.myInfo=n,this.myRoom=o},leaveRoom:async function(){await this.myRoom.leave(this.myInfo),console.log("leave")}}),l.prototype=Object.create(r.prototype),l.prototype.constructor=l,Object.assign(l.prototype,{subscribeAndAttach:function(e){if(console.log(e.publisher.id),console.log(this.myInfo),e.publisher.id===this.myInfo.id)return;let t=document.createElement("button");t.textContent=`${e.publisher.id}: ${e.contentType}`,this.buttonArea.appendChild(t),t.onclick=async()=>{let t;let{stream:o}=await this.myInfo.subscribe(e.id);switch(o.track.kind){case"video":t=document.getElementById("video");break;case"audio":(t=document.createElement("audio")).controls=!0,t.autoplay=!0;break;default:return}o.attach(t),this.remoteMediaArea.appendChild(t)}}});const c=document.getElementById("my-id"),s=document.getElementById("leave-button");document.getElementById("list-button");const d=document.getElementById("button-area"),m=document.getElementById("remote-media-area");(async()=>{let e=new URLSearchParams(window.location.search),t=new l(e.get("room"),d,m);await t.initMyContext(e.get("key")),c.textContent=t.myInfo.id,t.myRoom.publications.forEach(e=>{t.subscribeAndAttach(e)}),s.onclick=async()=>{t.leaveRoom(),c.textContent="leaved"}})();
//# sourceMappingURL=index.e9b45ed0.js.map
