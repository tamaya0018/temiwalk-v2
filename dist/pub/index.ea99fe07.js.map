{"mappings":"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","sources":["<anon>","src/pub/js/index.js","src/pub/js/publisher.js","src/pub/js/mediaController.js"],"sourcesContent":["var $parcel$global =\ntypeof globalThis !== 'undefined'\n  ? globalThis\n  : typeof self !== 'undefined'\n  ? self\n  : typeof window !== 'undefined'\n  ? window\n  : typeof global !== 'undefined'\n  ? global\n  : {};\nvar $parcel$modules = {};\nvar $parcel$inits = {};\n\nvar parcelRequire = $parcel$global[\"parcelRequire87e6\"];\nif (parcelRequire == null) {\n  parcelRequire = function(id) {\n    if (id in $parcel$modules) {\n      return $parcel$modules[id].exports;\n    }\n    if (id in $parcel$inits) {\n      var init = $parcel$inits[id];\n      delete $parcel$inits[id];\n      var module = {id: id, exports: {}};\n      $parcel$modules[id] = module;\n      init.call(module.exports, module, module.exports);\n      return module.exports;\n    }\n    var err = new Error(\"Cannot find module '\" + id + \"'\");\n    err.code = 'MODULE_NOT_FOUND';\n    throw err;\n  };\n\n  parcelRequire.register = function register(id, init) {\n    $parcel$inits[id] = init;\n  };\n\n  $parcel$global[\"parcelRequire87e6\"] = parcelRequire;\n}\n\nvar $hlpVk = parcelRequire(\"hlpVk\");\n\nvar $hEh8e = parcelRequire(\"hEh8e\");\nconst $8a55cc966ce4a09f$var$publisherPrototype = {\n    previewVideo: async function(localVideo) {\n        this.video = await (0, $hlpVk.SkyWayStreamFactory).createCameraVideoStream({\n            deviceId: this.cameraList.value\n        });\n        this.video.attach(localVideo);\n        await localVideo.play();\n    },\n    publishVideo: function() {\n        this.myInfo.publish(this.video).then(()=>{\n            console.log(\"publish success!\");\n        });\n    },\n    previewAudio: async function() {\n        this.mic = await (0, $hlpVk.SkyWayStreamFactory).createMicrophoneAudioStream({\n            deviceId: this.audioList.value\n        });\n    },\n    publishAudio: function() {\n        this.myInfo.publish(this.mic).then(()=>{\n            console.log(\"publish success!\");\n        });\n    }\n};\nfunction $8a55cc966ce4a09f$export$9abcd9565debde5d(roomName, cameraList, audioList) {\n    (0, $hEh8e.Member).call(this, roomName);\n    this.cameraList = cameraList;\n    this.audioList = audioList;\n}\n$8a55cc966ce4a09f$export$9abcd9565debde5d.prototype = Object.create((0, $hEh8e.Member).prototype);\n$8a55cc966ce4a09f$export$9abcd9565debde5d.prototype.constructor = $8a55cc966ce4a09f$export$9abcd9565debde5d;\nObject.assign($8a55cc966ce4a09f$export$9abcd9565debde5d.prototype, $8a55cc966ce4a09f$var$publisherPrototype);\n\n\nfunction $72a5247c2b9c23f2$export$f3ab9ff51c21cabc(mediaList, mediaType) {\n    navigator.mediaDevices.enumerateDevices().then((devices)=>{\n        const narrowedDevices = devices.filter((device)=>device.kind === mediaType);\n        narrowedDevices.forEach((device)=>{\n            const option = document.createElement(\"option\");\n            option.value = device.deviceId;\n            option.text = device.label;\n            mediaList.appendChild(option);\n        });\n    }).catch((err)=>{\n        console.log(err.name + \": \" + err.message);\n    });\n}\n\n\nconst $b3d8ca500fbe463d$var$myId = document.getElementById(\"my-id\");\nconst $b3d8ca500fbe463d$var$localVideo = document.getElementById(\"local-video\");\nconst $b3d8ca500fbe463d$var$cameraList = document.getElementById(\"camera-list\");\nconst $b3d8ca500fbe463d$var$audioList = document.getElementById(\"audio-list\");\nconst $b3d8ca500fbe463d$var$listButton = document.getElementById(\"list-button\");\nconst $b3d8ca500fbe463d$var$publishVideoButton = document.getElementById(\"publish-video-button\");\nconst $b3d8ca500fbe463d$var$publishAudioButton = document.getElementById(\"publish-audio-button\");\nconst $b3d8ca500fbe463d$var$myUrl = document.getElementById(\"url\");\n(async ()=>{\n    const searchParams = new URLSearchParams(window.location.search);\n    const me = new (0, $8a55cc966ce4a09f$export$9abcd9565debde5d)(searchParams.get(\"room\"), $b3d8ca500fbe463d$var$cameraList, $b3d8ca500fbe463d$var$audioList);\n    await me.initMyContext(searchParams.get(\"key\"));\n    $b3d8ca500fbe463d$var$myId.textContent = me.myInfo.id;\n    var url = \"localhost:1234/sub/?room=\" + searchParams.get(\"room\") + \"&key=\" + searchParams.get(\"key\") + \"&id=\" + me.myInfo.id;\n    $b3d8ca500fbe463d$var$myUrl.textContent = url;\n    $b3d8ca500fbe463d$var$listButton.onclick = ()=>{\n        (0, $72a5247c2b9c23f2$export$f3ab9ff51c21cabc)($b3d8ca500fbe463d$var$audioList, \"audioinput\");\n        (0, $72a5247c2b9c23f2$export$f3ab9ff51c21cabc)($b3d8ca500fbe463d$var$cameraList, \"videoinput\");\n    };\n    $b3d8ca500fbe463d$var$publishVideoButton.onclick = async ()=>{\n        await me.publishVideo();\n    };\n    $b3d8ca500fbe463d$var$publishAudioButton.onclick = async ()=>{\n        await me.publishAudio();\n    };\n    $b3d8ca500fbe463d$var$cameraList.onchange = async ()=>{\n        await me.previewVideo($b3d8ca500fbe463d$var$localVideo);\n    };\n    $b3d8ca500fbe463d$var$audioList.onchange = async ()=>{\n        await me.previewAudio();\n    };\n})();\n\n\n//# sourceMappingURL=index.ea99fe07.js.map\n","import { Publisher } from './publisher';\r\nimport { listMediaDevices } from './mediaController';\r\n\r\nconst myId               = document.getElementById('my-id');\r\nconst localVideo         = document.getElementById('local-video');\r\nconst cameraList         = document.getElementById('camera-list');\r\nconst audioList          = document.getElementById('audio-list');\r\nconst listButton         = document.getElementById('list-button');\r\nconst publishVideoButton = document.getElementById('publish-video-button');\r\nconst publishAudioButton = document.getElementById('publish-audio-button');\r\nconst myUrl              = document.getElementById('url');\r\n\r\n(async () => {\r\n\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n  const me = new Publisher(searchParams.get('room'), cameraList, audioList);\r\n  await me.initMyContext(searchParams.get('key'));\r\n\r\n  myId.textContent = me.myInfo.id;\r\n\r\n  var url = \"localhost:1234/sub/\" + \"?room=\" + searchParams.get('room') + \"&key=\" + searchParams.get('key') + \"&id=\" + me.myInfo.id;\r\n  myUrl.textContent = url;\r\n\r\n  listButton.onclick = () => {\r\n    listMediaDevices(audioList, 'audioinput');\r\n    listMediaDevices(cameraList, 'videoinput');\r\n  };\r\n  \r\n  publishVideoButton.onclick = async () => {\r\n    await me.publishVideo();\r\n  };\r\n\r\n  publishAudioButton.onclick = async () => {\r\n    await me.publishAudio();\r\n  };\r\n\r\n  cameraList.onchange = async () => {\r\n    await me.previewVideo(localVideo);\r\n  };\r\n\r\n  audioList.onchange = async () => {\r\n    await me.previewAudio();\r\n  };\r\n\r\n})();","import { SkyWayStreamFactory } from '@skyway-sdk/room';\r\nimport { Member } from '../../js/member';\r\n\r\nconst publisherPrototype = {\r\n\r\n  previewVideo: async function (localVideo) {\r\n    this.video = await SkyWayStreamFactory.createCameraVideoStream(\r\n      { deviceId: this.cameraList.value }\r\n    );\r\n    this.video.attach(localVideo);\r\n    await localVideo.play();\r\n  },\r\n  \r\n  publishVideo: function () {\r\n    this.myInfo.publish(this.video)\r\n      .then( () => {\r\n        console.log(\"publish success!\");\r\n      })\r\n  },\r\n\r\n  previewAudio: async function () {\r\n    this.mic = await SkyWayStreamFactory.createMicrophoneAudioStream(\r\n      { deviceId: this.audioList.value }\r\n    );\r\n  },\r\n  \r\n  publishAudio: function () {\r\n    this.myInfo.publish(this.mic)\r\n      .then( () => {\r\n        console.log(\"publish success!\");\r\n      })\r\n  },\r\n  \r\n};\r\n\r\nexport function Publisher(roomName, cameraList, audioList) {\r\n  Member.call(this, roomName);\r\n  this.cameraList = cameraList;\r\n  this.audioList = audioList;\r\n}\r\n\r\nPublisher.prototype = Object.create(Member.prototype);\r\nPublisher.prototype.constructor = Publisher;\r\n\r\nObject.assign(Publisher.prototype, publisherPrototype);","export function listMediaDevices (mediaList, mediaType) {\r\n\r\n  navigator.mediaDevices.enumerateDevices()\r\n    .then(devices => {\r\n      const narrowedDevices = devices.filter(device => device.kind === mediaType);\r\n\r\n      narrowedDevices.forEach(device => {\r\n        const option = document.createElement(\"option\");\r\n        option.value = device.deviceId;\r\n        option.text = device.label;\r\n        mediaList.appendChild(option);\r\n      });\r\n    })\r\n    .catch(err => {\r\n      console.log(err.name + \": \" + err.message);\r\n    })\r\n}"],"names":["$parcel$global","globalThis","self","window","global","$parcel$modules","$parcel$inits","parcelRequire","id","exports","init","module","call","err","Error","code","register","$hlpVk","$hEh8e","$8a55cc966ce4a09f$export$9abcd9565debde5d","roomName","cameraList","audioList","Member","$72a5247c2b9c23f2$export$f3ab9ff51c21cabc","mediaList","mediaType","navigator","mediaDevices","enumerateDevices","then","devices","narrowedDevices","filter","device","kind","forEach","option","document","createElement","value","deviceId","text","label","appendChild","catch","console","log","name","message","prototype","Object","create","constructor","assign","previewVideo","localVideo","video","SkyWayStreamFactory","createCameraVideoStream","attach","play","publishVideo","myInfo","publish","previewAudio","mic","createMicrophoneAudioStream","publishAudio","$b3d8ca500fbe463d$var$myId","getElementById","$b3d8ca500fbe463d$var$localVideo","$b3d8ca500fbe463d$var$cameraList","$b3d8ca500fbe463d$var$audioList","$b3d8ca500fbe463d$var$listButton","$b3d8ca500fbe463d$var$publishVideoButton","$b3d8ca500fbe463d$var$publishAudioButton","$b3d8ca500fbe463d$var$myUrl","searchParams","URLSearchParams","location","search","me","get","initMyContext","textContent","url","onclick","onchange"],"version":3,"file":"index.ea99fe07.js.map"}