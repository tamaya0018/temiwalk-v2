var e="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},t={},o={},i=e.parcelRequire87e6;null==i&&((i=function(e){if(e in t)return t[e].exports;if(e in o){var i=o[e];delete o[e];var n={id:e,exports:{}};return t[e]=n,i.call(n.exports,n,n.exports),n.exports}var a=Error("Cannot find module '"+e+"'");throw a.code="MODULE_NOT_FOUND",a}).register=function(e,t){o[e]=t},e.parcelRequire87e6=i);var n=(i("hlpVk"),i("hlpVk")),a=i("aohA3");function c(e){this.roomName=e}function s(e,t,o){c.call(this,e),this.cameraList=t,this.audioList=o}function l(e,t){navigator.mediaDevices.enumerateDevices().then(o=>{let i=o.filter(e=>e.kind===t);i.forEach(t=>{let o=document.createElement("option");o.value=t.deviceId,o.text=t.label,e.appendChild(o)})}).catch(e=>{console.log(e.name+": "+e.message)})}Object.assign(c.prototype,{initMyContext:async function(e){let t=await (0,n.SkyWayContext).Create((0,a.getToken)(e)),o=await (0,n.SkyWayRoom).FindOrCreate(t,{type:"p2p",name:this.roomName}),i=await o.join();this.myInfo=i,this.myRoom=o},leaveRoom:async function(){await this.myRoom.leave(this.myInfo),console.log("leave")}}),s.prototype=Object.create(c.prototype),s.prototype.constructor=s,Object.assign(s.prototype,{previewVideo:async function(e){this.video=await (0,n.SkyWayStreamFactory).createCameraVideoStream({deviceId:this.cameraList.value}),this.video.attach(e),await e.play()},publishVideo:function(){this.myInfo.publish(this.video).then(()=>{console.log("publish success!")})},previewAudio:async function(){this.mic=await (0,n.SkyWayStreamFactory).createMicrophoneAudioStream({deviceId:this.audioList.value})},publishAudio:function(){this.myInfo.publish(this.mic).then(()=>{console.log("publish success!")})}});const d=document.getElementById("my-id"),r=document.getElementById("local-video"),u=document.getElementById("camera-list"),m=document.getElementById("audio-list"),y=document.getElementById("list-button"),p=document.getElementById("publish-video-button"),h=document.getElementById("publish-audio-button"),f=document.getElementById("url");(async()=>{let e=new URLSearchParams(window.location.search),t=new s(e.get("room"),u,m);await t.initMyContext(e.get("key")),d.textContent=t.myInfo.id;var o="https://43.207.203.236/queue/?room="+e.get("room")+"&key="+e.get("key");f.textContent=o,y.onclick=()=>{l(m,"audioinput"),l(u,"videoinput")},p.onclick=async()=>{await t.publishVideo()},h.onclick=async()=>{await t.publishAudio()},u.onchange=async()=>{await t.previewVideo(r)},m.onchange=async()=>{await t.previewAudio()}})();
//# sourceMappingURL=index.67c1976b.js.map
